<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>インタラクティブ自由研究：赤毛組合の謎</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Noto+Sans+JP:wght@400;500&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Vintage Manuscript -->
    <!-- Application Structure Plan: 「探偵の事件簿」をテーマにした、タブ形式のシングルページアプリケーション。セクション（事件概要、登場人物、ホームズの推理、ヴィクトリア朝のロンドン、君の挑戦）を明確に分け、ユーザーが興味のある項目から自由に探索できるように設計。これにより、小学生が物語の要素を段階的かつ体系的に理解し、受動的な読書から能動的な学習へと移行することを促す。各セクションはクリックで表示が切り替わり、複雑な情報を小さな単位に分割して提示することで、学習負荷を軽減し、集中力を維持させる。 -->
    <!-- Visualization & Content Choices: 1. ホームズの推理フロー: [目的:整理] 報告書の表をインタラクティブなクリック式アコーディオンに変更。各ステップをクリックすると詳細が表示されるUIで、複雑な推理過程を段階的に学べるようにする。[手法:HTML/Tailwind/JS]。2. ホームズvsワトソン比較: [目的:比較] 静的な表に加え、Chart.jsのドーナツグラフで二人の性格（論理vs感情）を視覚化。抽象的な性格の違いを直感的に理解させる。[手法:Chart.js]。3. 事件現場マップ: [目的:整理] 質屋と銀行の位置関係をHTML/CSSで図解。クリックすると各場所の役割が表示され、地理的な関係性が犯罪計画の鍵であることを示す。[手法:HTML/Tailwind/JS]。4. ワークシート: [目的:エンゲージメント] 報告書の書き込み欄をHTMLの入力フォームに変換。ユーザーが直接ウェブ上で考察を記録できるようにし、主体的な参加を促す。[手法:HTML/JS]。 -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #FDF6E3; /* Warm Neutral Background */
        }
        h1, h2, h3, .font-serif {
            font-family: 'Noto Serif JP', serif;
        }
        .tab-active {
            background-color: #D2B48C; /* Tan */
            color: #3D2B1F; /* Dark Brown */
            border-bottom: 2px solid #8B4513; /* Saddle Brown */
        }
        .tab-inactive {
            background-color: #F5DEB3; /* Wheat */
            color: #5D4037; /* Brown */
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 300px;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        /* Print Styles */
        @media print {
            body {
                background-color: #fff !important;
                color: #000 !important;
                -webkit-print-color-adjust: exact; /* 背景色なども正確に印刷 */
                print-color-adjust: exact;
            }

            @page {
                size: A4 portrait; /* A4縦サイズ */
                margin: 1cm; /* 上下左右1cmの余白 */
            }

            /* タブ切り替えボタン、アコーディオンの開閉矢印、地図のヒントなど、印刷で不要な要素を非表示 */
            nav, .tab, .accordion-header span:last-child, #map-info, .map-item {
                display: none !important;
            }

            /* アコーディオンのヘッダーは表示するが、ボタンではなく通常のテキストとして扱う */
            .accordion-header {
                display: block !important;
                background-color: #f0f0f0 !important; /* 印刷時の背景色を調整 */
                color: #333 !important;
                border: 1px solid #ccc !important;
                padding: 0.5em 1em !important;
                margin-bottom: 0 !important; /* アコーディオン項目間の余白を調整 */
                font-weight: bold;
                cursor: default; /* カーソルをデフォルトに */
            }

            /* すべてのコンテンツセクションを印刷時に表示 */
            .content-section {
                display: block !important;
                page-break-after: avoid; /* セクション内での改ページを避ける */
                margin-bottom: 1.5em; /* セクション間の余白 */
                padding: 0 !important; /* パディングをリセット */
            }
            .content-section h2 {
                page-break-before: always; /* 各セクションのタイトル前に改ページ */
                margin-top: 1.5em; /* タイトル上部の余白 */
            }
            /* 最初のセクションは改ページしない */
            #tab1.content-section h2 {
                page-break-before: auto;
                margin-top: 0;
            }

            /* アコーディオンの中身をすべて展開して表示 */
            .accordion-content {
                max-height: none !important; /* 高さを制限しない */
                overflow: visible !important; /* はみ出しを許容 */
                display: block !important; /* 常に表示 */
                transition: none !important; /* アニメーションを無効化 */
                padding: 0.8em 1em !important; /* コンテンツのパディング */
                background-color: #fff !important;
                border: 1px solid #eee !important;
                border-top: none !important; /* ヘッダーとの境界線はなし */
                box-shadow: none !important;
                margin-top: 0 !important;
            }

            .accordion-item {
                margin-bottom: 0.5em !important; /* アコーディオン項目間のスペース */
                break-inside: avoid; /* アコーディオン項目内での改ページを避ける */
                border: none !important; /* ボーダーをリセット */
            }
            
            /* 全体的なデザインの調整（背景、シャドウ、ボーダーをシンプルに） */
            .container, main {
                background-color: transparent !important;
                box-shadow: none !important;
                border: none !important;
                padding: 0 !important;
                margin: 0 auto !important;
                width: 100% !important;
                max-width: 100% !important;
            }
            header {
                border-bottom: 2px solid #ccc !important; /* ヘッダーの境界線を調整 */
                padding-bottom: 0.5em !important;
                margin-bottom: 1em !important;
            }
            h1, h2, h3, h4 {
                color: #333 !important;
            }
            p, ul, li {
                color: #444 !important;
                line-height: 1.5;
            }
            .bg-\[\#F5DEB3\], .bg-\[\#F5DEB3\]\/50 {
                background-color: #f9f9f9 !important; /* 薄い背景色 */
                border: 1px solid #eee !important;
                box-shadow: none !important;
                padding: 1em !important;
            }
            .border-l-4 {
                border-left: 4px solid #ccc !important;
            }
            
            /* ワークシートの入力欄は、印刷時に枠線を表示して手書きを促す */
            textarea, input[type="text"] {
                border: 1px solid #ccc !important;
                background-color: #fff !important;
                padding: 0.5em !important;
                min-height: 3em; /* 適切な高さを確保 */
            }
            .w-full.h-48.p-2.border-2.border-dashed {
                border: 2px dashed #ccc !important;
                background-color: #fff !important;
                min-height: 150px; /* 絵を描くスペースを確保 */
            }

            /* 地図表示の調整 */
            #map {
                background-color: #f9f9f9 !important;
                border: 1px solid #ccc !important;
                padding: 1em !important;
                text-align: center;
                break-inside: avoid;
            }
            #map > div:first-child { /* サクス・コバーグ・スクエア */
                display: block !important;
                margin-bottom: 0.5em;
            }
            #map .flex {
                display: flex !important;
                justify-content: center !important; /* 中央寄せ */
                align-items: flex-start !important; /* 上揃え */
                height: auto !important; /* 高さを自動調整 */
                padding-top: 1em;
                padding-bottom: 1em;
            }
            #pawnshop, #bank {
                display: block !important;
                border: 1px solid #aaa !important; /* 実線にする */
                padding: 0.5em 1em !important;
                margin: 0 1em; /* 左右に余白 */
                cursor: default;
            }
            #pawnshop span, #bank span {
                font-size: 1.5em !important;
                line-height: 1;
                display: block;
                margin-bottom: 0.2em;
            }
            #pawnshop p, #bank p {
                font-size: 0.9em;
                font-weight: bold;
                color: #333;
            }

            /* トンネルの表示 */
            #map .absolute.bottom-1\/2,
            #map .absolute.top-1\/2 {
                position: static !important; /* 印刷時には相対位置に */
                display: block !important;
                width: 80% !important; /* 幅を調整 */
                margin: 1em auto !important; /* 上下の余白と中央寄せ */
                border-top: 2px dotted #666 !important;
                transform: none !important; /* transformを解除 */
            }
            #map .absolute.top-1\/2 .bg-gray-600 {
                position: static !important;
                background-color: #666 !important;
                color: #fff !important;
                display: inline-block !important;
                padding: 0.2em 0.5em !important;
                margin-top: -0.8em; /* ドット線の上に重なるように調整 */
            }

            /* Chart.jsグラフのコンテナ調整 */
            .chart-container {
                width: 250px !important; /* 印刷時に固定幅 */
                height: 250px !important; /* 印刷時に固定高 */
                max-width: none !important;
                max-height: none !important;
                margin-bottom: 1em;
                break-inside: avoid; /* グラフ内での改ページを避ける */
            }
            /* Chart.jsのcanvas要素自身に高さが設定されるため、コンテナの高さ調整が重要 */
            canvas {
                width: 100% !important;
                height: 100% !important;
            }
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
        
        <header class="text-center mb-8 border-b-4 border-double border-[#8B4513] pb-4">
            <h1 class="text-3xl md:text-5xl font-bold text-[#3D2B1F]">探偵の事件簿</h1>
            <p class="text-lg md:text-2xl text-[#5D4037] mt-2 font-serif">シャーロック・ホームズと『赤毛組合』の謎</p>
        </header>

        <nav class="flex flex-wrap justify-center gap-2 mb-8">
            <button data-tab="tab1" class="tab tab-active px-4 py-2 rounded-t-lg font-bold text-sm md:text-base transition-colors duration-300">事件の概要</button>
            <button data-tab="tab2" class="tab tab-inactive px-4 py-2 rounded-t-lg font-bold text-sm md:text-base transition-colors duration-300">登場人物</button>
            <button data-tab="tab3" class="tab tab-inactive px-4 py-2 rounded-t-lg font-bold text-sm md:text-base transition-colors duration-300">ホームズの推理</button>
            <button data-tab="tab4" class="tab tab-inactive px-4 py-2 rounded-t-lg font-bold text-sm md:text-base transition-colors duration-300">19世紀のロンドン</button>
            <button data-tab="tab5" class="tab tab-inactive px-4 py-2 rounded-t-lg font-bold text-sm md:text-base transition-colors duration-300">君の挑戦！</button>
        </nav>

        <main id="content" class="bg-white/50 backdrop-blur-sm p-6 rounded-lg shadow-lg border border-[#D2B48C]">
            
            <!-- Section 1: 事件の概要 -->
            <section id="tab1" class="content-section active">
                <h2 class="text-2xl font-bold mb-4 text-[#3D2B1F] border-b-2 border-[#D2B48C] pb-2">奇妙な仕事の始まり</h2>
                <p class="mb-4 leading-relaxed">質屋を営むジェイベズ・ウィルソン氏は、ある日「赤毛組合」という不思議な組織のメンバーに選ばれます。仕事の内容は、毎日数時間、事務所で百科事典を書き写すだけ。それなのに、もらえるお給料は週に4ポンドという破格の金額でした。ウィルソン氏はこの幸運に喜びますが、ある日突然、組合は解散してしまいます。いったい何が目的だったのでしょうか？</p>
                <div class="bg-[#F5DEB3] p-4 rounded-lg border-l-4 border-[#8B4513]">
                    <h3 class="font-bold text-lg text-[#3D2B1F]">この事件のポイント</h3>
                    <ul class="list-disc list-inside mt-2 space-y-1">
                        <li><span class="font-bold">謎の組織：</span>赤毛の人だけがメンバーになれる「赤毛組合」。</li>
                        <li><span class="font-bold">奇妙な仕事：</span>百科事典をひたすら書き写す。</li>
                        <li><span class="font-bold">高額な給料：</span>なぜかとても高いお給料が支払われる。</li>
                        <li><span class="font-bold">突然の解散：</span>理由も告げられず、組合は消えてしまう。</li>
                    </ul>
                </div>
                <p class="mt-4 leading-relaxed">このあまりに奇妙で、どこかおかしい事件の裏には、巧妙に仕組まれた大きな犯罪計画が隠されていました。名探偵シャーロック・ホームズが、この謎に挑みます。</p>
            </section>

            <!-- Section 2: 登場人物 -->
            <section id="tab2" class="content-section">
                <h2 class="text-2xl font-bold mb-4 text-[#3D2B1F] border-b-2 border-[#D2B48C] pb-2">事件をめぐる人々</h2>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-[#F5DEB3]/50 p-4 rounded-lg shadow">
                        <h3 class="text-xl font-bold text-[#3D2B1F]">シャーロック・ホームズ</h3>
                        <p class="text-sm text-[#5D4037] mb-2">世界一の名探偵</p>
                        <p>鋭い観察眼と論理的な思考で、どんな難事件も解決する。常識にとらわれず、物事の本質を見抜く天才。</p>
                    </div>
                    <div class="bg-[#F5DEB3]/50 p-4 rounded-lg shadow">
                        <h3 class="text-xl font-bold text-[#3D2B1F]">ジョン・H・ワトソン</h3>
                        <p class="text-sm text-[#5D4037] mb-2">ホームズの相棒で医師</p>
                        <p>ホームズの親友であり、彼の活躍を記録する伝記作家。読者と同じ視点で事件に驚き、感動する人間味あふれる人物。</p>
                    </div>
                    <div class="bg-[#F5DEB3]/50 p-4 rounded-lg shadow">
                        <h3 class="text-xl font-bold text-[#3D2B1F]">ジェイベズ・ウィルソン</h3>
                        <p class="text-sm text-[#5D4037] mb-2">事件の依頼人</p>
                        <p>ロンドンで質屋を営む、立派な赤毛の持ち主。少し欲張りで、お人好しな性格が事件に巻き込まれるきっかけとなる。</p>
                    </div>
                    <div class="bg-[#F5DEB3]/50 p-4 rounded-lg shadow">
                        <h3 class="text-xl font-bold text-[#3D2B1F]">ヴィンセント・スポールディング</h3>
                        <p class="text-sm text-[#5D4037] mb-2">ウィルソン氏の助手</p>
                        <p>熱心に働く若者だが、その正体はイギリスで最も悪名高い犯罪者の一人、ジョン・クレイ。写真が趣味で、よく店の地下室にこもっている。</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: ホームズの推理 -->
            <section id="tab3" class="content-section">
                <h2 class="text-2xl font-bold mb-4 text-[#3D2B1F] border-b-2 border-[#D2B48C] pb-2">名探偵の思考をたどる</h2>
                <p class="mb-6">ホームズは、一見バラバラに見える小さな手がかりを繋ぎ合わせ、事件の全体像を明らかにします。彼の推理のステップを一つずつ見ていきましょう。各ステップをクリックすると詳細が表示されます。</p>
                <div id="accordion" class="space-y-2">
                    <div class="accordion-item border border-[#D2B48C] rounded-lg">
                        <button class="accordion-header w-full text-left p-4 bg-[#F5DEB3] hover:bg-[#D2B48C] transition-colors rounded-t-lg font-bold flex justify-between items-center">
                            <span>ステップ1：問題の提示</span>
                            <span class="text-xl">▼</span>
                        </button>
                        <div class="accordion-content bg-white/80 p-4 rounded-b-lg">
                            <p>依頼人ウィルソン氏から「赤毛組合」の奇妙な話を聞く。あまりに都合が良すぎる話の中に、何か裏があると直感する。</p>
                        </div>
                    </div>
                    <div class="accordion-item border border-[#D2B48C] rounded-lg">
                        <button class="accordion-header w-full text-left p-4 bg-[#F5DEB3] hover:bg-[#D2B48C] transition-colors rounded-t-lg font-bold flex justify-between items-center">
                            <span>ステップ2：情報収集</span>
                            <span class="text-xl">▼</span>
                        </button>
                        <div class="accordion-content bg-white/80 p-4 rounded-b-lg">
                            <p>助手のスポールディングのズボンの膝が汚れていること、彼が地下室によくこもることに注目。そして、質屋のすぐ近くに大きな銀行があることを確認する。</p>
                        </div>
                    </div>
                    <div class="accordion-item border border-[#D2B48C] rounded-lg">
                        <button class="accordion-header w-full text-left p-4 bg-[#F5DEB3] hover:bg-[#D2B48C] transition-colors rounded-t-lg font-bold flex justify-between items-center">
                            <span>ステップ3：仮説を立てる</span>
                            <span class="text-xl">▼</span>
                        </button>
                        <div class="accordion-content bg-white/80 p-4 rounded-b-lg">
                            <p>「赤毛組合」はウィルソン氏を店から遠ざけるための口実ではないか？ 犯人たちは、その間に質屋の地下から隣の銀行へトンネルを掘っているのではないか？と推理する。</p>
                        </div>
                    </div>
                     <div class="accordion-item border border-[#D2B48C] rounded-lg">
                        <button class="accordion-header w-full text-left p-4 bg-[#F5DEB3] hover:bg-[#D2B48C] transition-colors rounded-t-lg font-bold flex justify-between items-center">
                            <span>ステップ4：仮説の検証</span>
                            <span class="text-xl">▼</span>
                        </button>
                        <div class="accordion-content bg-white/80 p-4 rounded-b-lg">
                            <p>質屋の前で地面を杖で叩き、音の響きから地下に空洞があることを確かめる。これで仮説が正しいと確信する。</p>
                        </div>
                    </div>
                    <div class="accordion-item border border-[#D2B48C] rounded-lg">
                        <button class="accordion-header w-full text-left p-4 bg-[#F5DEB3] hover:bg-[#D2B48C] transition-colors rounded-t-lg font-bold flex justify-between items-center">
                            <span>ステップ5：計画の阻止</span>
                            <span class="text-xl">▼</span>
                        </button>
                        <div class="accordion-content bg-white/80 p-4 rounded-b-lg">
                            <p>警察と協力し、銀行の地下金庫で待ち伏せをする。トンネルから現れた犯人たちを捕まえ、銀行強盗を未然に防ぐ。</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4: 19世紀のロンドン -->
            <section id="tab4" class="content-section">
                <h2 class="text-2xl font-bold mb-4 text-[#3D2B1F] border-b-2 border-[#D2B48C] pb-2">物語の舞台：ヴィクトリア朝のロンドン</h2>
                <p class="mb-6">『赤毛組合』が書かれたのは19世紀末、ヴィクトリア女王がイギリスを治めていた時代です。当時のロンドンは、世界で最も活気のある都市でしたが、その華やかさの裏には影もありました。</p>
                <div class="grid md:grid-cols-2 gap-6 items-start">
                    <div>
                        <h3 class="text-xl font-bold text-[#3D2B1F] mb-2">繁栄と犯罪の街</h3>
                        <p class="mb-4">産業革命によってイギリスは「世界の工場」と呼ばれ、ロンドンは金融の中心地でした。しかし、急激な発展は貧富の差を広げ、巧妙な犯罪が生まれる土壌ともなりました。</p>
                        <h3 class="text-xl font-bold text-[#3D2B1F] mb-2">新聞と情報</h3>
                        <p>この時代、新聞は最も重要な情報源でした。「赤毛組合」の募集も新聞広告で行われました。犯人たちは、多くの人が信頼する新聞を悪用したのです。</p>
                    </div>
                    <div class="bg-[#F5DEB3]/50 p-4 rounded-lg shadow border border-[#D2B48C]">
                        <h3 class="text-lg font-bold text-center mb-2">事件現場の見取り図</h3>
                        <div id="map" class="relative bg-white p-4 rounded">
                            <div class="text-center mb-2 font-bold">サクス・コバーグ・スクエア</div>
                            <div class="flex justify-around items-center h-48">
                                <div id="pawnshop" class="map-item text-center p-2 border-2 border-dashed border-[#8B4513] rounded cursor-pointer">
                                    <span class="text-2xl">♇</span>
                                    <p class="font-bold">ウィルソンの質屋</p>
                                </div>
                                <div id="bank" class="map-item text-center p-2 border-2 border-dashed border-[#8B4513] rounded cursor-pointer">
                                     <span class="text-2xl">🏦</span>
                                    <p class="font-bold">銀行</p>
                                </div>
                            </div>
                            <div class="absolute bottom-1/2 left-0 right-0 border-t-4 border-dotted border-gray-600 transform translate-y-4"></div>
                             <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-gray-600 text-white px-2 py-1 rounded text-sm">トンネル</div>
                        </div>
                        <p id="map-info" class="text-center mt-2 text-sm text-[#5D4037] h-10">※建物をクリックすると説明が表示されます。</p>
                    </div>
                </div>
                 <div class="mt-8">
                    <h3 class="text-xl font-bold text-[#3D2B1F] mb-4 text-center">ホームズとワトソン：最強のコンビ</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="text-center">
                            <h4 class="text-lg font-bold">シャーロック・ホームズ</h4>
                            <div class="chart-container">
                                <canvas id="holmesChart"></canvas>
                            </div>
                            <p class="mt-2 text-sm">論理と観察力で真実を追求する。</p>
                        </div>
                        <div class="text-center">
                            <h4 class="text-lg font-bold">ジョン・ワトソン</h4>
                            <div class="chart-container">
                                <canvas id="watsonChart"></canvas>
                            </div>
                            <p class="mt-2 text-sm">友情と人間性でホームズを支える。</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: 君の挑戦！ -->
            <section id="tab5" class="content-section">
                <h2 class="text-2xl font-bold mb-4 text-[#3D2B1F] border-b-2 border-[#D2B48C] pb-2">君も名探偵になろう！</h2>
                <p class="mb-6">物語を読んできて、君が気づいたこと、考えたことをまとめてみよう。絵を描いたり、自分なりの推理を書き加えたりして、オリジナルの研究を完成させよう！</p>
                
                <div class="space-y-6">
                    <div>
                        <h3 class="text-xl font-bold text-[#3D2B1F] mb-2">ワークシート1：キャラクター分析</h3>
                        <p class="mb-2">ホームズとワトソンの性格や役割を、君の言葉でまとめてみよう。</p>
                        <textarea class="w-full h-24 p-2 border border-[#D2B48C] rounded-lg focus:ring-2 focus:ring-[#8B4513] focus:outline-none" placeholder="例：ホームズは冷静だけど、ワトソンは優しい。二人がいるから事件が解決できるんだと思う。"></textarea>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-[#3D2B1F] mb-2">ワークシート2：私の推理</h3>
                        <p class="mb-2">もし君が探偵だったら、どんな手がかりに注目する？ホームズとは違う方法で犯人を捕まえられるかな？</p>
                        <textarea class="w-full h-24 p-2 border border-[#D2B48C] rounded-lg focus:ring-2 focus:ring-[#8B4513] focus:outline-none" placeholder="例：最初から助手が怪しいと思った。毎日地下室に行くなんておかしいから、こっそり後をつけてみる。"></textarea>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-[#3D2B1F] mb-2">ワークシート3：感想とイラスト</h3>
                        <p class="mb-2">この物語で一番面白かったシーンや、印象に残ったことを書こう。となりには、そのシーンの絵を描いてみよう！</p>
                        <div class="grid md:grid-cols-2 gap-4">
                            <textarea class="w-full h-48 p-2 border border-[#D2B48C] rounded-lg focus:ring-2 focus:ring-[#8B4513] focus:outline-none" placeholder="一番ドキドキしたのは、銀行の地下で犯人を待ち伏せするシーンです。"></textarea>
                            <div class="w-full h-48 p-2 border-2 border-dashed border-[#D2B48C] rounded-lg flex items-center justify-center text-gray-500">
                                <p>ここに絵を描こう！</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tabs = document.querySelectorAll('.tab');
            const contentSections = document.querySelectorAll('.content-section');
            const accordionHeaders = document.querySelectorAll('.accordion-header');
            const mapItems = document.querySelectorAll('.map-item');
            const mapInfo = document.getElementById('map-info');

            const mapDescriptions = {
                pawnshop: 'ウィルソン氏が働く質屋。犯人たちはここを拠点にトンネルを掘りました。',
                bank: '犯人たちの本当の狙い。地下金庫には大量の金貨が保管されていました。'
            };

            // Tab functionality (for screen display only)
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => {
                        t.classList.remove('tab-active');
                        t.classList.add('tab-inactive');
                    });
                    tab.classList.add('tab-active');
                    tab.classList.remove('tab-inactive');

                    contentSections.forEach(section => {
                        section.classList.remove('active');
                    });

                    const activeTabContent = document.getElementById(tab.dataset.tab);
                    activeTabContent.classList.add('active');
                });
            });

            // Accordion functionality (for screen display only)
            accordionHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const item = header.parentElement;
                    
                    // Close other accordions
                    document.querySelectorAll('.accordion-item').forEach(otherItem => {
                        if (otherItem !== item) {
                            otherItem.querySelector('.accordion-content').style.maxHeight = null;
                            otherItem.querySelector('.accordion-header span:last-child').textContent = '▼';
                        }
                    });

                    // Toggle current accordion
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        header.querySelector('span:last-child').textContent = '▼';
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px";
                        header.querySelector('span:last-child').textContent = '▲';
                    }
                });
            });

            // Map functionality (for screen display only)
            mapItems.forEach(item => {
                item.addEventListener('click', () => {
                    mapInfo.textContent = mapDescriptions[item.id];
                });
            });

            // Chart rendering
            let holmesChartInstance, watsonChartInstance;

            function createChart(ctx, data, options) {
                return new Chart(ctx, {
                    type: 'doughnut',
                    data: data,
                    options: options
                });
            }

            const chartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            color: window.matchMedia && window.matchMedia('print').matches ? '#333' : '#3D2B1F' // 印刷時は黒、それ以外は茶色
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed !== null) {
                                    label += context.parsed + '%';
                                }
                                return label;
                            }
                        }
                    }
                },
                cutout: '60%'
            };

            const holmesData = {
                labels: ['論理的思考', '観察力', '知識'],
                datasets: [{
                    label: 'ホームズの能力',
                    data: [50, 30, 20],
                    backgroundColor: ['#3D2B1F', '#8B4513', '#D2B48C'],
                    borderColor: '#FDF6E3',
                    borderWidth: 3
                }]
            };

            const watsonData = {
                labels: ['人間性・友情', '記録力', '医療知識'],
                datasets: [{
                    label: 'ワトソンの能力',
                    data: [50, 30, 20],
                    backgroundColor: ['#5D4037', '#A0522D', '#F5DEB3'],
                    borderColor: '#FDF6E3',
                    borderWidth: 3
                }]
            };

            // Render charts on DOMContentLoaded so they are available for printing
            function renderCharts() {
                if (!holmesChartInstance) {
                    const holmesCtx = document.getElementById('holmesChart');
                    if (holmesCtx) {
                        holmesChartInstance = createChart(holmesCtx.getContext('2d'), holmesData, chartOptions);
                    }
                }
                if (!watsonChartInstance) {
                    const watsonCtx = document.getElementById('watsonChart');
                    if (watsonCtx) {
                        watsonChartInstance = createChart(watsonCtx.getContext('2d'), watsonData, chartOptions);
                    }
                }
            }

            // Initial chart render
            renderCharts();
        });
    </script>
</body>
</html>